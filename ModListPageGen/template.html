<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{Title}}</title>
  <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
  <style>
    footer {
      display: flex;
      gap: 40px;
      font-size: 1rem;
    }
    .credit-toggle p {
      margin: 0;
    }
    label {
      margin-left: 5px;
    }
    #simple-list {
      display: none;
    }
    h1 {
      margin-bottom: 1rem;  
    }
    body {
      grid-template-columns: 1fr min(55em,90%) 1fr;
    }
    .details {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 100%;
    }
    .notice {
      padding: 1rem;
      margin: 0;
    }
    .stats {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      border-top: 1px solid var(--border);
      margin-top: 10px 
    }
    .details p {
      font-size: 1rem;
      margin-top: 0.25rem;
      margin-bottom: 0.25rem;
    }
    .card-title {
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 1.5rem;
    }
    .adult-content {
      color: var(--code);
    }
    .summary {
      font-size: 1rem;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2; /* number of lines to show */
      line-clamp: 2;
      -webkit-box-orient: vertical;
    }
    li {
      margin-bottom: 0.5rem;
    }
    .credit-toggle {
      display: flex;
      justify-content: space-between;
    }
    ul {
      padding-left: 1rem;
    }
    #detail-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(25rem, 1fr));
      grid-gap: 1rem;
    }
    .accent {
      color: var(--accent);
    }
    button {
      padding: 7px;
      color: var(--accent);
      background-color: transparent;
      margin-bottom: 15px;
    }
    button:hover {
      color: var(--accent-text);
      background-color: var(--accent);
    }
    .btn-group {
      display: flex;
      gap: 20px;
    }
    .two-col {
      columns: 2;
      -webkit-columns: 2;
      -moz-columns: 2;
    }
  </style>
</head>
<body>
<main>
  <h1 id="top">{{Title}}</h1>
  <p>Author: {{Author}} | {{ModCount}} Mods</p>
  <div class="credit-toggle">
    <p>Created with <a href="https://www.nexusmods.com/stardewvalley/mods/32609" target="_blank">BarleyZP's Mod List Generator</a>.</p>
    <div><input type="checkbox" id="toggle" name="toggle"><label for="toggle">Simple List</label></div>
  </div>
  <hr>
  <details class="filters">
    <summary>Category Filters</summary>
    <div class="btn-group"><button id="category-enable">Enable All</button><button id="category-disable">Disable All</button></div>
    <div class="two-col">
      {{#each Categories}}
      <div><input class="category-box" type="checkbox" id="{{CategoryClass}}" name="{{CategoryClass}}" value="{{CategoryClass}}" checked><label for="{{CategoryClass}}">{{CategoryName}} <span class="accent">({{CategoryCount}})</span></label></div>
      {{/each}}
    </div>
  </details>
  <details class="filters">
    <summary>Dependency Filters</summary>
    <div class="btn-group"><button id="dep-enable">Enable All</button><button id="dep-disable">Disable All</button></div>
    <div id="dep-tree" class="two-col">
      {{#each DependencyTree}}
      <div><input class="dep-box" type="checkbox" id="{{ClassName}}" name="{{ClassName}}" value="{{ClassName}}" checked><label for="{{ClassName}}">{{Name}} <span class="accent">({{DepsCount}})</span></label></div>
      {{/each}}
    </div>
  </details>
  <hr>
  <div id="detail-list">
  {{#each Mods}}
  <div class="notice {{CategoryClass}} {{DepsClasses}}">
    <div class="details">
      <div>
        <h2 class="card-title">{{Name}}</h2>
        <p>By: {{Author}} {{#if ContentPackFor}}| For {{ContentPackFor}}{{/if}}</p>
        {{#if NexusId}}
        <p><a target="_blank" href="https://www.nexusmods.com/stardewvalley/mods/{{NexusId}}">Nexus: {{Name}}</a></p>
        {{/if}}
        <p class="summary">{{Summary}}</p>
      </div>
      {{#if HasNexus}}
      <div class="stats">
        <p>{{Downloads}} Downloads</p>
        <p>{{Endorsements}} Endorsements</p>
        {{#if AdultContent}}
        <p class="adult-content">Contains Adult Content</p>
        {{/if}}
      </div>
      {{/if}}
    </div>
  </div>
  {{/each}}
  </div>
  <div id="simple-list">
    <ul>
      {{#each Mods}}
      <li class="{{CategoryClass}} {{DepsClasses}}">
        {{#if NexusId}}
          <a target="_blank" href="https://www.nexusmods.com/stardewvalley/mods/{{NexusId}}">{{Name}}</a>
        {{else}}
          {{Name}}
        {{/if}}
        by {{Author}}
        {{#if ContentPackFor}} | For {{ContentPackFor}}{{/if}}
        {{#if AdultContent}} | <span class="adult-content">Contains Adult Content</span>{{/if}}
      </li>
      {{/each}}
    </ul>
  </div>
</main>
<footer>
  <a href="#top">Back to top</a>
  <a href="https://github.com/lisyce/StardewValleyMods/tree/main/ModListPageGen">GitHub</a>
</footer>
<script>
  const checkbox = document.getElementById("toggle");
  const detailed = document.getElementById("detail-list");
  const simple = document.getElementById("simple-list");
  checkbox.addEventListener("change", () => {
    if (checkbox.checked) {
      simple.style.display = "block";
      detailed.style.display = "none";
    } else {
      simple.style.display = "none";
      detailed.style.display = "grid";
    }
  })
  for (let box of document.querySelectorAll(".category-box, .dep-box")) {
    box.addEventListener("change", () => {
        for (let el of document.getElementsByClassName(box.value)) {
          if (visible(el)) {
            el.style.removeProperty("display");
          } else {
            el.style.display = "none";
          }
      }
    })
  }
  function visible(el) {
    // chekc category filter
    let foundCategoryOn = false;
    for (let box of document.getElementsByClassName("category-box")) {
      if (box.checked && el.classList.contains(box.value)) {
        foundCategoryOn = true;
        break;
      }
    }
    if (!foundCategoryOn) return false;
    // check dep filters (at least one gotta be on)
    for (let box of document.getElementsByClassName("dep-box")) {
      if (box.checked && el.classList.contains(box.value)) {
        return true;
      }
    }
    return false;
  }
  document.getElementById("category-enable").addEventListener("click", () => {
    for (let box of document.getElementsByClassName("category-box")) {
      box.checked = true
      box.dispatchEvent(new Event("change"))
    }
  })
  document.getElementById("dep-enable").addEventListener("click", () => {
    for (let box of document.getElementsByClassName("dep-box")) {
      box.checked = true
      box.dispatchEvent(new Event("change"))
    }
  })
  document.getElementById("category-disable").addEventListener("click", () => {
    for (let box of document.getElementsByClassName("category-box")) {
      box.checked = false
      box.dispatchEvent(new Event("change"))
    }
  })
  document.getElementById("dep-disable").addEventListener("click", () => {
    for (let box of document.getElementsByClassName("dep-box")) {
      box.checked = false
      box.dispatchEvent(new Event("change"))
    }
  })
</script>
</body>
</html>